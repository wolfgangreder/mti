<?xml version="1.0" encoding="UTF-8"?>

<!--
    Document   : model.xml
    Created on : 26. Februar 2010, 18:09
    Author     : wolfi
    Description:
        Purpose of the document follows.
-->

<!DOCTYPE database SYSTEM 'http://db.apache.org/torque/dtd/database.dtd'>
<database name="mti">
  <!-- filesystem implementation -->
  <table name="fileobjects">
    <column name="id" type="CHAR" size="36" required="true" primaryKey="true"/>
    <column name="parent" type="CHAR" size="36" required="true" primaryKey="false"/>
    <column name="name" type="VARCHAR" size="100" required="true"/>
    <column name="folder" type="BIT" required="true" default="0"/>
    <unique name="ndx_fileobjects_name">
      <unique-column name="name"/>
      <unique-column name="parent"/>
    </unique>
    <foreign-key name="fk_fileobjects_parent" foreignTable="fileobjects" onUpdate="cascade" onDelete="restrict">
      <reference foreign="id" local="parent"/>
    </foreign-key>
  </table>

  <table name="filecontent">
    <column name="id" type="CHAR" size="36" required="true" primaryKey="true"/>
    <column name="content" type="BLOB"/>
    <column name="contentsize" type="BIGINT" required="true" default="-1"/>
    <column name="mime" type="VARCHAR" size="100" required="true" default=""/>
  </table>

  <table name="fileattr">
    <column name="fileobject" type="CHAR" size="36" required="true" primaryKey="true"/>
    <column name="name" type="VARCHAR" size="100" required="true" primaryKey="true"/>
    <column name="content" type="BLOB"/>
    <column name="contentsize" type="BIGINT" required="true" default="-1"/>
    <column name="mime" type="VARCHAR" size="100" required="true" default=""/>
    <foreign-key name="fk_fileattr_fileobject" foreignTable="fileobjects" onDelete="cascade" onUpdate="cascade">
      <reference foreign="id" local="fileobject"/>
    </foreign-key>
  </table>

  <table name="fileobject_content">
    <column name="fileobject" type="CHAR" size="36" required="true" primaryKey="true"/>
    <column name="filecontent" type="CHAR" size="36" required="true"/>
    <index name="ndx_fileobject_content">
      <index-column name="filecontent"/>
    </index>
    <foreign-key name="fk_fileobject_content_fo" foreignTable="fileobjects" onDelete="cascade" onUpdate="cascade">
      <reference local="fileobject" foreign="id"/>
    </foreign-key>
    <foreign-key name="fk_fileobject_content_co" foreignTable="filecontent" onDelete="cascade" onUpdate="cascade">
      <reference foreign="id" local="filecontent"/>
    </foreign-key>
  </table>

  <!-- end filesystem implementation -->


  <table name="contacttype">
    <column name="name" type="VARCHAR" size="50" required="true" primaryKey="true"/>
  </table>

  <table name="externalkind">
    <column name="name" type="VARCHAR" size="50" required="true" primaryKey="true"/>
  </table>

  <table name="modelcondition">
    <column name="name" type="VARCHAR" size="50" required="true" primaryKey="true"/>
  </table>

  <table name="externalrepository">
    <column name="id" type="CHAR" size="36" required="true" primaryKey="true"/>
    <column name="name" type="VARCHAR" size="50" required="true"/>
    <column name="baseurl" type="VARCHAR" size="250" required="true"/>
    <column name="kinds" type="VARCHAR" size="250" required="true"/>
    <column name="readonly" type="BIT" required="true" default="0"/>
    <column name="immutable" type="BIT" required="true" default="0"/>
    <column name="description" type="CLOB" required="false"/>
    <unique name="ndx_externalrepository_name">
      <unique-column name="name"/>
    </unique>
  </table>

  <table name="externals">
    <column name="id" type="CHAR" size="36" required="true" primaryKey="true"/>
    <column name="filename" type="VARCHAR" size="100" required="true"/>
    <column name="orig_filename" type="VARCHAR" size="100" required="false"/>
    <column name="repository" type="CHAR" size="36" required="true"/>
    <column name="kind" type="VARCHAR" size="50" required="true"/>
    <column name="mime_type" type="VARCHAR" size="100"/>
    <column name="description" type="CLOB"/>
    <foreign-key name="fk_externals_repository" foreignTable="externalrepository" onDelete="restrict" onUpdate="cascade">
      <reference local="repository" foreign="id"/>
    </foreign-key>
    <foreign-key name="fk_kind_externalkind" foreignTable="externalkind" onDelete="restrict" onUpdate="cascade">
      <reference local="kind" foreign="name"/>
    </foreign-key>
  </table>

  <table name="modelscale">
    <column name="id" type="CHAR" size="36" required="true" primaryKey="true"/>
    <column name="name" type="VARCHAR" size="10" required="true"/>
    <column name="scalefactor" type="DOUBLE" required="true"/>
    <column name="trackwidth" type="DOUBLE" required="true"/>
    <column name="family" type="CHAR" size="36" required="true"/>
    <foreign-key name="fk_scale_family" foreignTable="modelscale" onDelete="restrict" onUpdate="cascade">
      <reference local="family" foreign="id"/>
    </foreign-key>
  </table>

  <table name="contact">
    <column name="id" type="CHAR" size="36" required="true" primaryKey="true"/>
    <column name="name" type="VARCHAR" size="100" required="true"/>
    <column name="address1" type="VARCHAR" size="100" required="false"/>
    <column name="address2" type="VARCHAR" size="100" required="false"/>
    <column name="zip" type="VARCHAR" size="10" required="false"/>
    <column name="city" type="VARCHAR" size="100" required="false"/>
    <column name="country" type="VARCHAR" size="100" required="false"/>
    <column name="email" type="VARCHAR" size="100" required="false"/>
    <column name="www" type="VARCHAR" size="100" required="false"/>
    <column name="phone1" type="VARCHAR" size="50" required="false"/>
    <column name="phone2" type="VARCHAR" size="50" required="false"/>
    <column name="fax" type="VARCHAR" size="50" required="false"/>
    <column name="description" type="CLOB" required="false"/>
    <column name="shopaddress" type="VARCHAR" size="100" required="false"/>
    <unique name="ndx_contact_name">
      <unique-column name="name"/>
    </unique>
    <index name="ndx$contact_country">
      <index-column name="country"/>
    </index>
  </table>

  <table name="contacttypes">
    <column name="id" type="CHAR" size="36" required="true" primaryKey="true"/>
    <column name="name" type="VARCHAR" size="50" required="true" primaryKey="true"/>
    <foreign-key foreignTable="contact" onDelete="cascade" onUpdate="cascade" name="fk_contacttype_contact">
      <reference foreign="id" local="id"/>
    </foreign-key>
    <foreign-key foreignTable="contacttype" onDelete="restrict" onUpdate="cascade" name="fk_contacttype_types">
      <reference foreign="name" local="name"/>
    </foreign-key>
  </table>

  <table name="inventoryobject">
    <column name="id" type="CHAR" size="36" required="true" primaryKey="true"/>
    <column name="name" type="VARCHAR" size="100" required="true"/>
    <column name="description" type="CLOB"/>
    <column name="price" type="DECIMAL" size="18,5"/>
    <column name="dateofpurchase" type="DATE"/>
    <column name="productno" type="VARCHAR" size="50"/>
    <column name="manufacturer" type="CHAR" size="36" required="true"/>
    <column name="retailer" type="CHAR" size="36" required="true"/>
    <column name="condition" type="VARCHAR" size="50" required="true" default="NEW"/>
    <column name="masterimage" type="CHAR" size="36"/>
    <column name="lastModified" type="TIMESTAMP" required="true"/>
    <foreign-key foreignTable="contact" onDelete="restrict" onUpdate="cascade" name="fk_invetoryobj_manufacturer">
      <reference foreign="id" local="manufacturer"/>
    </foreign-key>
    <foreign-key foreignTable="contact" onDelete="restrict" onUpdate="cascade" name="fk_invetoryobj_retailer">
      <reference foreign="id" local="retailer"/>
    </foreign-key>
    <foreign-key foreignTable="modelcondition" onDelete="restrict" onUpdate="cascade" name="fk_inventoryobj_modelcondition">
      <reference foreign="name" local="condition"/>
    </foreign-key>
    <foreign-key foreignTable="hasexternal" name="fk_inventoryobject_masterimage" onDelete="restrict" onUpdate="cascade">
      <reference foreign="externals" local="masterimage"/>
      <reference foreign="inventoryobject" local="id"/>
    </foreign-key>
  </table>

  <table name="hasexternal">
    <column name="externals" type="CHAR" size="36" required="true" primaryKey="true"/>
    <column name="inventoryobject" type="CHAR" size="36" required="true" primaryKey="true"/>
    <foreign-key name="fk_hasexternal_externals" foreignTable="externals" onDelete="restrict" onUpdate="cascade">
      <reference foreign="id" local="externals"/>
    </foreign-key>
    <foreign-key name="fk_hasexternal_invetoryobject" foreignTable="inventoryobject" onDelete="cascade" onUpdate="cascade">
      <reference foreign="id" local="inventoryobject"/>
    </foreign-key>
  </table>

  <table name="sparepart">
    <column name="id" type="CHAR" size="36" required="true" primaryKey="true"/>
    <column name="amount" type="INTEGER"/>
    <foreign-key name="sparepart_inventoryobject" foreignTable="inventoryobject" onDelete="cascade" onUpdate="cascade">
      <reference foreign="id" local="id"/>
    </foreign-key>
  </table>

  <table name="decoder">
    <column name="id" type="CHAR" size="36" required="true" primaryKey="true"/>
    <column name="address" type="VARCHAR" size="20"/>
    <foreign-key name="decoder_sparepart" foreignTable="sparepart" onDelete="cascade" onUpdate="cascade">
      <reference foreign="id" local="id"/>
    </foreign-key>
  </table>

  <table name="decoderparams">
    <column name="decoder" type="CHAR" size="36" required="true" primaryKey="true"/>
    <column name="externals" type="CHAR" size="36" required="true" primaryKey="true"/>
    <column name="isactive" type="BIT" default="false" required="true"/>
    <column name="memo" type="CLOB"/>
    <foreign-key name="fk_decoderparams_decoder" foreignTable="decoder" onDelete="cascade" onUpdate="cascade">
      <reference foreign="id" local="decoder"/>
    </foreign-key>
    <foreign-key name="fk_decoderparams_externals" foreignTable="externals" onDelete="restrict" onUpdate="cascade">
      <reference foreign="id" local="externals"/>
    </foreign-key>
  </table>

  <table name="decodersound">
    <column name="decoder" type="CHAR" size="36" required="true" primaryKey="true"/>
    <column name="externals" type="CHAR" size="36" required="true" primaryKey="true"/>
    <column name="isactive" type="BIT" default="false" required="true"/>
    <column name="memo" type="CLOB"/>
    <foreign-key name="fk_decodersound_decoder" foreignTable="decoder" onDelete="cascade" onUpdate="cascade">
      <reference foreign="id" local="decoder"/>
    </foreign-key>
    <foreign-key name="fk_decodersound_externals" foreignTable="externals" onDelete="restrict" onUpdate="cascade">
      <reference foreign="id" local="externals"/>
    </foreign-key>
  </table>

  <table name="era">
    <column name="id" type="CHAR" size="36" required="true" primaryKey="true"/>
    <column name="name" type="VARCHAR" size="100" required="true"/>
    <column name="yearfrom" type="INTEGER" required="true"/>
    <column name="yearto" type="INTEGER" required="false"/>
    <column name="country" type="CHAR" size="2" required="false"/>
    <column name="comment" type="CLOB"/>
    <unique name="ndx_era_name">
      <unique-column name="name"/>
      <unique-column name="country"/>
    </unique>
  </table>

  <table name="locomotive">
    <column name="id" type="CHAR" size="36" required="true" primaryKey="true"/>
    <column name="locnumber" type="CHAR" size="50" required="false"/>
    <column name="decoder" type="CHAR" size="36"/>
    <column name="era" type="CHAR" size="36"/>
    <column name="modelscale" type="CHAR" size="36" required="true"/>
    <column name="length_" type="DOUBLE"/>
    <column name="width" type="DOUBLE"/>
    <column name="height" type="DOUBLE"/>
    <column name="weight" type="DOUBLE"/>
    <column name="wheelarrangement" type="VARCHAR" size="20"/>
    <column name="kind" type="VARCHAR" size="50"/>
    <column name="locclass" type="VARCHAR" size="50"/>
    <column name="company" type="VARCHAR" size="100"/>
    <column name="country" type="VARCHAR" size="50"/>
    <foreign-key name="locomotive_inventoryobject" foreignTable="inventoryobject" onDelete="cascade" onUpdate="cascade">
      <reference foreign="id" local="id"/>
    </foreign-key>
    <foreign-key name="locomotive_decoder" foreignTable="decoder" onDelete="restrict" onUpdate="cascade">
      <reference foreign="id" local="decoder"/>
    </foreign-key>
    <foreign-key name="locomotive_era" foreignTable="era" onDelete="restrict" onUpdate="cascade">
      <reference foreign="id" local="era"/>
    </foreign-key>
    <foreign-key name="locomotive_scale" foreignTable="modelscale" onDelete="restrict" onUpdate="cascade">
      <reference foreign="id" local="modelscale"/>
    </foreign-key>
    <index name="locomotive_kind">
      <index-column name="kind"/>
    </index>
    <index name="locomotive_company">
      <index-column name="company"/>
    </index>
    <index name="locomotive_country">
      <index-column name="country"/>
    </index>
    <index name="locomotive_wheelarrangement">
      <index-column name="wheelarrangement"/>
    </index>
    <index name="locomotive_locnumber">
      <index-column name="locnumber"/>
    </index>
  </table>

  <table name="wagon">
    <column name="id" type="CHAR" size="36" required="true" primaryKey="true"/>
    <column name="decoder" type="CHAR" size="36"/>
    <column name="era" type="CHAR" size="36"/>
    <column name="modelscale" type="CHAR" size="36" required="true"/>
    <column name="length_" type="DOUBLE"/>
    <column name="width" type="DOUBLE"/>
    <column name="height" type="DOUBLE"/>
    <column name="weight" type="DOUBLE"/>
    <column name="kind" type="VARCHAR" size="50"/>
    <column name="wagonclass" type="VARCHAR" size="50"/>
    <column name="numaxels" type="INTEGER"/>
    <column name="company" type="VARCHAR" size="100"/>
    <column name="country" type="VARCHAR" size="50"/>
    <foreign-key name="wagon_inventoryobject" foreignTable="inventoryobject" onDelete="cascade" onUpdate="cascade">
      <reference foreign="id" local="id"/>
    </foreign-key>
    <foreign-key name="wagon_decoder" foreignTable="decoder" onDelete="restrict" onUpdate="cascade">
      <reference foreign="id" local="decoder"/>
    </foreign-key>
    <foreign-key name="wagon_era" foreignTable="era" onDelete="restrict" onUpdate="cascade">
      <reference foreign="id" local="era"/>
    </foreign-key>
    <foreign-key name="wagon_scale" foreignTable="modelscale" onDelete="restrict" onUpdate="cascade">
      <reference foreign="id" local="modelscale"/>
    </foreign-key>
    <index name="wagon_company">
      <index-column name="company"/>
    </index>
    <index name="wagon_country">
      <index-column name="country"/>
    </index>
    <index name="wagon_kind">
      <index-column name="kind"/>
    </index>
  </table>



</database>
